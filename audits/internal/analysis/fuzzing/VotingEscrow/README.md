## Echidna

Ethereum smart contract fuzzer: https://github.com/crytic/echidna
Install:
``` sh
pip3 install slither-analyzer --user
git clone --depth 1 https://github.com/crytic/echidna
```
#### download compiled Echidna
```
curl -fL https://github.com/crytic/echidna/releases/download/v2.0.1/echidna-test-2.0.1-Ubuntu-18.04.tar.gz -o echidna-test-2.0.1-Ubuntu-18.04.tar.gz
tar xvf echidna-test-2.0.1-Ubuntu-18.04.tar.gz
```
### run fuzzing
```
./echidna-test audit/internal/analysis/fuzzing/VotingEscrow/VotingEscrowVerySimple.sol 
```

```
                                                          ┌─────────────────────────────────────────────────────Echidna 2.0.1────────────────────────────────────────────────────┐                                                          
                                                          │ Tests found: 1                                                                                                       │                                                          
                                                          │ Seed: 1492611614190538740                                                                                            │                                                          
                                                          │ Unique instructions: 2108                                                                                            │                                                          
                                                          │ Unique codehashes: 1                                                                                                 │                                                          
                                                          │ Corpus size: 10                                                                                                      │                                                          
                                                          │─────────────────────────────────────────────────────────Tests────────────────────────────────────────────────────────│                                                          
                                                          │ echidna_test: FAILED! with ReturnFalse                                                                               │                                                          
                                                          │                                                                                                                      │                                                          
                                                          │ Current action: shrinking (37/5000)                                                                                  │                                                          
                                                          │ Call sequence:                                                                                                       │                                                          
                                                          │ 1.*fallback*() from: 0x0000000000000000000000000000000000010000                                                      │                                                          
                                                          │ 2.*wait*                                                                                                             │                                                          
                                                          │ 3._checkpoint(0x0,(1,                                                                                                │                                                          
                                                          │   34544426307336459824282254492848915587702384128050577681548687404608407695853),(25561122406390602216130012925513690│                                                          
                                                          │   0),(8351, -431, 3979242, 9207422323015737176665148607440801350093997700607511945735490316725724041263,             │                                                          
                                                          │   75529238110239435798004182317210431320850412251777050633572848435617752260992),10404,-93368,36845042230187747498578│                                                          
                                                          │   from: 0x0000000000000000000000000000000000010000                                                                   │                                                          
                                                          │ 4.*wait*                                                                                                             │                                                          
                                                          │ 5._checkpoint(0x0,(0,                                                                                                │                                                          
                                                          │   39437688171834411696287367749702965373369529319678409649347517675259589182648),(19322910381113577654451252481950888│                                                          
                                                          │   25),(82293, -18521, 33521, 115792089237316195423570985008687907853269984665640564039457584007913129639931,         │                                                          
                                                          │   115792089237316195423570985008687907853269984665640564039457584007913129639681),113636,-13448,251586226206244092833│                                                          
                                                          │   from: 0x0000000000000000000000000000000000010000                                                                   │                                                          
                                                          │ 6.*fallback*() from: 0x0000000000000000000000000000000000010000                                                      │                                                          
                                                          │ 7.*fallback*() from: 0x0000000000000000000000000000000000010000                                                      │                                                          
                                                          │ 8.*fallback*() from: 0x0000000000000000000000000000000000010000                                                      │                                                          
                                                          │ 9._checkpoint(0x0,(0, 222267279237207463866172079774913343340262518491743459681683885470794550013),(-1,              │                                                          
                                                          │   528458446774757184008122230709121759069144885689479630777401231253451557878),(4857066069702841352779163012608612705│                                                          
                                                          │   -17, 4255149874639264087273591845105662071915856545879973069842082217270758194443, 646,                            │                                                          
                                                          │   17480707574969652133404841878808164461748333707640941922552424785513097157101),445110330647008885478766915711647328│                                                          
                                                          │   from: 0x0000000000000000000000000000000000010000                                                                   │                                                          
                                                          │ 10._checkpoint(0x0,(0,                                                                                               │                                                          
                                                          │    3538585004522314710868466344743557001252076576902631554059208472225596909564),(16496676534495815757818502217262189│                                                          
                                                          │    70),(54600, -1843, 214320, 2817251101332559100954995872706589304954949713765803785537080397776804485375,          │                                                          
                                                          │    110531519295468941736897387865650187990674879232566593608553998513929185997235),31,-860,12687675423461542821243302│                                                          
                                                          │    from: 0x0000000000000000000000000000000000010000                                                                  │                                                          
                                                          │ 11._checkpoint(0x0,(8349933954617696196546194741204402782,                                                           │                                                          
                                                          │    674011979428282254395604062850608572930407170807091325406039921559945816778),(666674070714071763,                 │                                                          
                                                          │    2358856326925082597108135400822569967106145584275956182538436068546482275685),(19445598290007725512278416626631099│                                                          
                                                          │    90, 161468, 233095443949235228331652539408804109841573027418853798466746615425890196217,                          │                                                          
                                                          │    2698038434103506789623166981451933026076445346761077171105164097514108666777),0,2363294772857288905155289218110924│                                                          
                                                          │    from: 0x0000000000000000000000000000000000010000                                                                  │                                                          
                                                          │ 12.*fallback*() from: 0x0000000000000000000000000000000000010000 Time delay: 23451 seconds Block delay: 38937        │                                                          
                                                          │ 13.*wait*                                                                                                            │                                                          
                                                          │ 14._checkpoint(0x0,(29772263320519176794294029938092055,                                                             │                                                          
                                                          │    74566364324066511728034795935733256973194210637254219768551086110659482872321),(2154358745225967557289967217936290│                                                          
                                                          │    21320558),(148, 1, 20095664715085439206660764754625989581507603340521698764653122566026600884454,                 │                                                          
                                                          │    37614252156022072229205333498208031124914351816002821638685289776863256788245,                                    │                                                          
                                                          │    51816786317248880139667974455582332533787996726241222618313187418705006677345),33394171223413555068433217810535951│                                                          
                                                          │    from: 0x0000000000000000000000000000000000010000                                                                  │                                                          
                                                          │ 15.*fallback*() from: 0x0000000000000000000000000000000000010000                                                     │                                                          
                                                          │ 16.*fallback*() from: 0x0000000000000000000000000000000000010000                                                     │                                                          
                                                          │ 17.*fallback*() from: 0x0000000000000000000000000000000000010000                                                     │                                                          
                                                          │ 18._checkpoint(0x0,(21153437609207197081091268169462583361, 81),(136767680534432732938551530321452265,               │                                                          
                                                          │    70911154115899515960534054131625368488241865029173335366954619029637285876500),(-2, 0,                            │                                                          
                                                          │    959538419839093625048120801175124071878998947450713657243186797989485680245, 365,                                 │                                                          
                                                          │    64747076895241330573526880744293248608420509808180451331171000813634652680791),83486771648055753874750819670872782│                                                          
                                                          │    from: 0x0000000000000000000000000000000000010000                                                                  │                                                          
                                                          │ 19._checkpoint(0x0,(0,                                                                                               │                                                          
                                                          │    606206610918934247552584053526865473697779359433189457357172526098605543664),(832670054846526377006466733020679895│                                                          
                                                          │    51),(313, -83, 772, 877825379583686461579575942860660304768566439832687068773004960673252760798,                  │                                                          
                                                          │    7743608074285418694690581877725053088898785897339453499439288939842989397),67,-25,4315424544416320093014972680817)│                                                          
                                                          │    from: 0x0000000000000000000000000000000000010000                                                                  │                                                          
                                                          │ 20._checkpoint(0x0,(88609737160622000611745020739572356150,                                                          │                                                          
                                                          │    1328482829745936626502494638064012780740772489070245255257731082406073679562),(1138,                              │                                                          
                                                          │    65973063065561108068841534175731388586448936528860957979149545679195144632),(239,                                 │                                                          
                                                          │    4647873703454314365629467529353821537,                                                                            │                                                          echidna_test: failed!                                     └──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘  
```

### run fuzzing with close as possible VotingEscrow. 30-05-22
```
                                                          ┌─────────────────────────────────────────────────────Echidna 2.0.1────────────────────────────────────────────────────┐                                                          
                                                          │ Tests found: 1                                                                                                       │                                                          
                                                          │ Seed: 6901020868330168219                                                                                            │                                                          
                                                          │ Unique instructions: 7142                                                                                            │                                                          
                                                          │ Unique codehashes: 1                                                                                                 │                                                          
                                                          │ Corpus size: 26                                                                                                      │                                                          
                                                          │─────────────────────────────────────────────────────────Tests────────────────────────────────────────────────────────│                                                          
                                                          │ echidna_test: PASSED!                                                                                                │                                                          
                                                          └──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘                                                          
                                                                                                   Campaign complete, C-c or esc to exit                                            
```

### run fuzzing. Not security issue. But need pay attention
#### notes for function _balanceOfLocked(address account, uint64 ts) internal returns (uint256 vBalance) 
```
./echidna-test audit/internal/analysis/fuzzing/VotingEscrow/VotingEscrowFuzzing.sol --config echidna.yaml

                                                          ┌─────────────────────────────────────────────────────Echidna 2.0.1────────────────────────────────────────────────────┐                                                          
                                                          │ Tests found: 1                                                                                                       │                                                          
                                                          │ Seed: -3465254596330744870                                                                                           │                                                          
                                                          │ Unique instructions: 3690                                                                                            │                                                          
                                                          │ Unique codehashes: 1                                                                                                 │                                                          
                                                          │ Corpus size: 1                                                                                                       │                                                          
                                                          │─────────────────────────────────────────────────────────Tests────────────────────────────────────────────────────────│                                                          
                                                          │ echidna_test: FAILED! with ReturnFalse                                                                               │                                                          
                                                          │                                                                                                                      │                                                          
                                                          │ Call sequence:                                                                                                       │                                                          
                                                          │ 1.withdraw() Time delay: 604436 seconds Block delay: 56515                                                           │                                                          
                                                          │ 2.getVotes(0x30000) Time delay: 149680 seconds Block delay: 51213                                                    │                                                          
                                                          └──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘                                                          
                                                                                                   Campaign complete, C-c or esc to exit                                                                                                    echidna_test: failed!                                                                                                                                           
```

details:
config: 
```
multi-abi: true                                                                                                                                                                                                                             
corpusDir: fuzzing_results 
```
fuzzing_results - details of fuzzing

